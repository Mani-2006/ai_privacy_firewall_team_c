‚úÖ Graphiti core imported successfully
‚úÖ Team A temporal framework loaded successfully
üöÄ Starting Enhanced Privacy API Service (Team A + C Integration)
Team A Temporal Framework: ‚úÖ Available
INFO:     Started server process [60595]
INFO:     Waiting for application startup.
üöÄ Starting Enhanced Privacy API Service (Team A + C Integration)
‚úÖ Base privacy ontology created
‚úÖ Base privacy ontology created
‚úÖ OpenAI API configured with gpt-4o-mini
   Key: sk-proj-SFYRdFomzvnd...
   Using OpenAI for privacy decision intelligence
‚úÖ Graphiti initialized with OpenAI at bolt://localhost:7687
   Using OpenAI gpt-4o-mini for LLM reasoning
   Neo4j password: 12345678
‚úÖ Neo4j fallback driver initialized
‚úÖ Team C privacy components initialized
2025-11-05 14:47:49 - INFO - Successfully initialized Graphiti knowledge graph
2025-11-05 14:47:49 - WARNING - Graphiti search requires async implementation - returning empty results
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8003 (Press CTRL+C to quit)
‚úÖ Team A temporal components initialized
üåü Enhanced API service ready!
üîç DEBUG: openai_enabled = True
üîç DEBUG: privacy_request = {'requester': 'emergency_doctor', 'data_field': 'patient_heart_rate', 'purpose': 'cardiac_arrest_emergency', 'context': 'emergency_department', 'emergency': False, 'temporal_analysis': {'decision': 'ALLOW', 'confidence': 0.5, 'reasoning': 'Temporal evaluation', 'emergency_override': True, 'urgency_level': 'critical', 'time_window_valid': True}, 'organizational_analysis': None}
üîç DEBUG: Calling make_enhanced_privacy_decision
üß† Making REAL LLM-powered privacy decision via OpenAI API
üì° Making OpenAI API call for privacy decision...
2025-11-05 14:48:17 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
üì° OpenAI Response: {
  "allowed": false,
  "reasoning": "The request for access to the 'patient_heart_rate' data field is made by an 'emergency_doctor' in a non-emergency context. Although the requester is a medical professional, the context indicates that this is not an emergency situation, which does not meet the criteria for overriding normal access restrictions. Therefore, access is denied.",
  "confidence": 0.9,
  "data_sensitivity": "high"
}
‚ö†Ô∏è  Direct OpenAI classification not implemented yet
   Using fallback classification logic
üß† REAL LLM Decision: DENY
üß† REAL LLM Reasoning: The request for access to the 'patient_heart_rate' data field is made by an 'emergency_doctor' in a non-emergency context. Although the requester is a medical professional, the context indicates that this is not an emergency situation, which does not meet the criteria for overriding normal access restrictions. Therefore, access is denied.
üß† REAL LLM Confidence: 0.9
‚úÖ LLM-powered decision: DENY
üîç DEBUG: LLM decision = {'allowed': False, 'reason': "The request for access to the 'patient_heart_rate' data field is made by an 'emergency_doctor' in a non-emergency context. Although the requester is a medical professional, the context indicates that this is not an emergency situation, which does not meet the criteria for overriding normal access restrictions. Therefore, access is denied.", 'confidence': 0.9, 'data_classification': {'field': 'patient_heart_rate', 'data_type': 'MedicalData', 'sensitivity': 'RestrictedData', 'context_dependent': False, 'equivalents': [], 'reasoning': ['Contains medical terminology']}, 'emergency_used': False, 'integration_ready': True, 'llm_powered': True, 'timestamp': '2025-11-05T09:18:18.045460+00:00', 'openai_response': '{\n  "allowed": false,\n  "reasoning": "The request for access to the \'patient_heart_rate\' data field is made by an \'emergency_doctor\' in a non-emergency context. Although the requester is a medical professional, the context indicates that this is not an emergency situation, which does not meet the criteria for overriding normal access restrictions. Therefore, access is denied.",\n  "confidence": 0.9,\n  "data_sensitivity": "high"\n}'}
2025-11-05 14:48:22 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:48:22 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:48:23 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:48:23 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:48:23 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:48:23 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:48:26 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:48:35 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:48:36 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:48:37 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:48:37 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:48:38 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:48:38 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:48:38 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:48:38 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:48:39 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:48:40 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:48:40 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:48:41 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:48:41 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:48:41 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:48:43 - INFO - Completed add_episode in 25800.169944763184 ms
‚úÖ Created Graphiti privacy decision episode: generated
   Decision: DENIED
   LLM-powered reasoning stored in Graphiti knowledge graph
   Timestamp: 2025-11-05T09:18:18Z (Local: 2025-11-05 09:18:18 UTC)
   Using LLM + Graphiti integration (no fallback needed)
INFO:     127.0.0.1:60021 - "POST /privacy-decision HTTP/1.1" 200 OK
üîç DEBUG: openai_enabled = True
üîç DEBUG: privacy_request = {'requester': 'hr_manager', 'data_field': 'employee_directory', 'purpose': 'routine_hr_review', 'context': 'human_resources', 'emergency': False, 'temporal_analysis': {'decision': 'DENY', 'confidence': 0.5, 'reasoning': 'Temporal evaluation', 'emergency_override': False, 'urgency_level': 'normal', 'time_window_valid': True}, 'organizational_analysis': None}
üîç DEBUG: Calling make_enhanced_privacy_decision
üß† Making REAL LLM-powered privacy decision via OpenAI API
üì° Making OpenAI API call for privacy decision...
2025-11-05 14:49:06 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
üì° OpenAI Response: {
  "allowed": true,
  "reasoning": "The requester is an HR manager, and the purpose of the request is for a routine HR review, which typically involves accessing the employee directory. The employee directory is considered personal data, and as an HR manager, the requester is authorized to access this information for HR-related functions. There are no emergency conditions that would necessitate overriding access controls, and the context of human resources aligns with the requester's role.",
  "confidence": 0.9,
  "data_sensitivity": "medium"
}
‚ö†Ô∏è  Direct OpenAI classification not implemented yet
   Using fallback classification logic
üß† REAL LLM Decision: ALLOW
üß† REAL LLM Reasoning: The requester is an HR manager, and the purpose of the request is for a routine HR review, which typically involves accessing the employee directory. The employee directory is considered personal data, and as an HR manager, the requester is authorized to access this information for HR-related functions. There are no emergency conditions that would necessitate overriding access controls, and the context of human resources aligns with the requester's role.
üß† REAL LLM Confidence: 0.9
‚úÖ LLM-powered decision: ALLOW
üîç DEBUG: LLM decision = {'allowed': True, 'reason': "The requester is an HR manager, and the purpose of the request is for a routine HR review, which typically involves accessing the employee directory. The employee directory is considered personal data, and as an HR manager, the requester is authorized to access this information for HR-related functions. There are no emergency conditions that would necessitate overriding access controls, and the context of human resources aligns with the requester's role.", 'confidence': 0.9, 'data_classification': {'field': 'employee_directory', 'data_type': 'PersonalData', 'sensitivity': 'InternalData', 'context_dependent': False, 'equivalents': [], 'reasoning': []}, 'emergency_used': False, 'integration_ready': True, 'llm_powered': True, 'timestamp': '2025-11-05T09:19:06.359333+00:00', 'openai_response': '{\n  "allowed": true,\n  "reasoning": "The requester is an HR manager, and the purpose of the request is for a routine HR review, which typically involves accessing the employee directory. The employee directory is considered personal data, and as an HR manager, the requester is authorized to access this information for HR-related functions. There are no emergency conditions that would necessitate overriding access controls, and the context of human resources aligns with the requester\'s role.",\n  "confidence": 0.9,\n  "data_sensitivity": "medium"\n}'}
2025-11-05 14:49:09 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:09 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:09 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:09 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:10 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:10 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:13 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:13 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:14 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:15 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:15 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:15 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:15 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:15 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:16 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:16 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:17 - INFO - Completed add_episode in 11078.851222991943 ms
‚úÖ Created Graphiti privacy decision episode: generated
   Decision: ALLOWED
   LLM-powered reasoning stored in Graphiti knowledge graph
   Timestamp: 2025-11-05T09:19:06Z (Local: 2025-11-05 09:19:06 UTC)
   Using LLM + Graphiti integration (no fallback needed)
INFO:     127.0.0.1:60054 - "POST /privacy-decision HTTP/1.1" 200 OK
üîç DEBUG: openai_enabled = True
üîç DEBUG: privacy_request = {'requester': 'temporary_contractor', 'data_field': 'quarterly_revenue_reports', 'purpose': 'unauthorized_access_attempt', 'context': 'external_vendor', 'emergency': False, 'temporal_analysis': {'decision': 'DENY', 'confidence': 0.5, 'reasoning': 'Temporal evaluation', 'emergency_override': False, 'urgency_level': 'low', 'time_window_valid': True}, 'organizational_analysis': None}
üîç DEBUG: Calling make_enhanced_privacy_decision
üß† Making REAL LLM-powered privacy decision via OpenAI API
üì° Making OpenAI API call for privacy decision...
2025-11-05 14:49:22 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
üì° OpenAI Response: {
  "allowed": false,
  "reasoning": "The requester is a temporary contractor attempting to access quarterly revenue reports, which are classified as financial data. Financial data should only be accessible to authorized financial personnel or auditors. Since the purpose of the request is labeled as 'unauthorized_access_attempt', it indicates that the requester does not have the necessary authorization to access this data. Additionally, the context of the request being from an external vendor further restricts access, as contractors typically have limited access rights. Therefore, the request is denied.",
  "confidence": 1.0,
  "data_sensitivity": "high"
}
‚ö†Ô∏è  Direct OpenAI classification not implemented yet
   Using fallback classification logic
üß† REAL LLM Decision: DENY
üß† REAL LLM Reasoning: The requester is a temporary contractor attempting to access quarterly revenue reports, which are classified as financial data. Financial data should only be accessible to authorized financial personnel or auditors. Since the purpose of the request is labeled as 'unauthorized_access_attempt', it indicates that the requester does not have the necessary authorization to access this data. Additionally, the context of the request being from an external vendor further restricts access, as contractors typically have limited access rights. Therefore, the request is denied.
üß† REAL LLM Confidence: 1.0
‚úÖ LLM-powered decision: DENY
üîç DEBUG: LLM decision = {'allowed': False, 'reason': "The requester is a temporary contractor attempting to access quarterly revenue reports, which are classified as financial data. Financial data should only be accessible to authorized financial personnel or auditors. Since the purpose of the request is labeled as 'unauthorized_access_attempt', it indicates that the requester does not have the necessary authorization to access this data. Additionally, the context of the request being from an external vendor further restricts access, as contractors typically have limited access rights. Therefore, the request is denied.", 'confidence': 1.0, 'data_classification': {'field': 'quarterly_revenue_reports', 'data_type': 'PersonalData', 'sensitivity': 'InternalData', 'context_dependent': False, 'equivalents': [], 'reasoning': []}, 'emergency_used': False, 'integration_ready': True, 'llm_powered': True, 'timestamp': '2025-11-05T09:19:22.735144+00:00', 'openai_response': '{\n  "allowed": false,\n  "reasoning": "The requester is a temporary contractor attempting to access quarterly revenue reports, which are classified as financial data. Financial data should only be accessible to authorized financial personnel or auditors. Since the purpose of the request is labeled as \'unauthorized_access_attempt\', it indicates that the requester does not have the necessary authorization to access this data. Additionally, the context of the request being from an external vendor further restricts access, as contractors typically have limited access rights. Therefore, the request is denied.",\n  "confidence": 1.0,\n  "data_sensitivity": "high"\n}'}
2025-11-05 14:49:24 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:25 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:25 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:25 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:25 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:25 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:25 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:26 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:29 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:32 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:33 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:34 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:34 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:34 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:34 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:35 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:36 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:37 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:38 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-05 14:49:42 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-11-05 14:49:43 - INFO - Completed add_episode in 20312.190055847168 ms
‚úÖ Created Graphiti privacy decision episode: generated
   Decision: DENIED
   LLM-powered reasoning stored in Graphiti knowledge graph
   Timestamp: 2025-11-05T09:19:22Z (Local: 2025-11-05 09:19:22 UTC)
   Using LLM + Graphiti integration (no fallback needed)
INFO:     127.0.0.1:60069 - "POST /privacy-decision HTTP/1.1" 200 OK
